# 数理モデルの導入・演習

到達目標
- 数理モデルの意義と考え方を理解する．
- 簡単なモデルを通じて基礎力を確認する．

<!-- 
アイデア
- （情報数理学科の学びと本講義の学びの関係）まだ数学科なのでここは触れなくて良い．
- 情報とはデータ．データは現実を数値化したもの．現実をよく知ることでデータをうまく扱えるようになる．
- 現実をよく知ることとは，どのようなメカニズムで現象が起きているのか，加えて数理的構造を理解すること．
- 数学的に扱うには数学を自在に使えることが必要．
- 数理モデルが一番うまくいっているのは物理学．次に数理生物学
-->

## 現実と数学の違い

### 数理モデルとは

広辞苑で「モデル」を引くと
<br>
②模型。雛型。
<br>
③現象や構造を理論的に抽象化したもの。
<br>
④模範。手本。

同じく「模型」を引くと
<br>
①同形のものを造るための型。ひながた。ぼけい。
<br>
②実物の形に似せて造ったもの。

- モデルガン：実物そっくりに作った玩具の銃
- モデルルーム：実物と同じ作りをした見本の部屋

<span style="color:red">模型とは，何か本物があり，それを真似して作られるもの．</span>

本物…実現象（自然現象・社会現象・人間活動など）

```{tip}
実現象の例

- ものの落下
- 星の運行
- 冷房による部屋の冷え方
- 光の届き方
- 毛穴のでき方
- 腸内細菌叢の状況
- チーターの模様のでき方
- 人口の変動
- 感染症の流行
- 渋滞のでき方
- 株価の変動
- サッカー選手の動き
```

### データ分析から数理モデリングへ

世の中のものは<span style="color:red">数値</span>として観測される．
その数値がどのようにして定まるかは，物理法則や統計的なルールなどによって決まる．

そのルールを見出すのがモデリングという作業になる．
特に数学的なルールを見出す場合を数理モデリングと呼び，それにより造られる模型を「<span style="color:red">数理モデル</span>」と呼ぶ．
数理モデルを用いれば，現実のルールを再現しているので，未知の現象の予測に役立つことがある．

しかしながら，数理モデルは現実そのまま丸ごと再現しているわけではなく<span style="color:red">人間が見出したルールのみを再現している</span>ため，見出したルール外の現象に対しては予測がうまくいかなくなることに注意すること．

### 数理モデルの要素

数理モデルは以下の３つの要素からなる．

- **変数**：対象となる現象の状態・性質・量などを数字やラベルで表したもの．
- **数理構造**：変数が従うルールを数学的に表現したもの．数理モデルの骨格．
- **パラメタ**：数理モデルの表現可能性を担う定数．これを調節することでデータを説明する．

### モデリングの分類

モデリングと呼ばれる手続きは目的に応じて大きく2つに分類できる[1]．

- **理解志向型のモデリング**：データの背後にあるメカニズムの理解を目指す．
  - 例：数理モデル
  - 利点
    - メカニズムのアナロジーから他の現象へと応用しやすく，汎用性が高い．
    - 数理的構造や変数の実現象における意味を理解しやすい．
  - 欠点
    - 人間の理解できるレベルまで単純化されているために現実のデータに合わないことがある．
    - 定量的な予測精度が低いことが多い．
- **応用志向型のモデリング**：データを用いて未来の予測・対象の制御・新たなデータの生成を目指す．
  - 例：機械学習モデルなど
  - 利点
    - 予測・制御に直接役に立つ．
    - 複雑でメカニズムを見出しにくい場合に有効である．
  - 欠点
    - データに偏りがあると誤った結論を導くことがある．（バイアス）
    - メカニズムが分からないために，モデルの適用範囲が曖昧になる．

### 数値シミュレーション

数理モデルにおいてパラメタを変化させたときに変数の値がどのように変化するかを確かめる作業をシミュレーションと呼ぶ．
複雑な数理モデルの構造や性質を調べる場合には，シミュレーションが有効な手段になることが多い．
また，実験の難しい現象に対して模擬的な実験を実施することができる．

特にコンピュータを用いた数値的なシミュレーションを数値シミュレーションと呼ぶ．
数値シミュレーションを実施するためには，コンピュータ上で実行するためのアルゴリズムをプログラミング言語を用いて実装する必要がある．
プログラミング言語には様々なものがあり，用途や目的に応じて使い分けられるが，本講義ではPythonを用いる．

## 微分積分の復習

以下の5問に取り組むこと．
始めの25分間は何も見ずに回答すること．
次の15分間は分からなかった箇所を調べながら，青ペンで回答すること．

```{note}
**復習１：微分**

次の関数 $f$ の導関数 $f^{\prime}(x)$ を求めよ．

(1) $f(x) = (1-x)^2(1+x)^2$．
<br>
(2) $f(x) = e^{2 x}$．
<br>
(3) $f(x) = \sin(2\pi x)$．
<br>
(4) $f(x) = \log\left( \dfrac{x}{2} \right)$，ただし$x > 0$．
<br>
(5) $f(x) = \dfrac{1-x}{x^2}$，ただし$x \neq 0$．
<br>
(6) $f(x) = x^2 e^{3x}$
<br>
(7) $f(x) = x \log{x}$
<br>
(8) $f(x) = \sin(x^2)$．
```

```{note}
**復習２：極大・極小**

関数 $f(x) = (1-x)^2(1+x)^2$ の極大値・極小値とそれを取る $x$ を全て求めよ．
```

```{note}
**復習３：定積分**

次の定積分を計算せよ．

(1) $\displaystyle \int_0^1 (1-x)^2 \, dx$
<br>
(2) $\displaystyle \int_0^{\pi} \sin(x) \, dx$
<br>
(3) $\displaystyle \int_{1}^{e} \dfrac{1}{x} \, dx$
<br>
(4) $\displaystyle \int_0^1 x e^x \, dx$
<br>
(5) $\displaystyle \int_0^{\pi/2} \cos^2 x \, dx$
```

```{note}
**復習４：偏微分**

次の2変数関数 $f$ の2次導関数 $\frac{\partial^2 f}{\partial x^2}$，$\frac{\partial^2 f}{\partial x \partial y}$，$\frac{\partial^2 f}{\partial y^2}$ を求めよ．

(1) $f(x,y) = \dfrac{y}{x^2+y^2}$，ただし$(x,y) \neq (0,0)$．
```

```{note}
**復習５：重積分**

次の2重積分を計算せよ．

(1) $\displaystyle \iint_{D} (x+y) \, dx\,dy$，
ただし領域は $D=\{(x,y)\mid 0\leq x\leq 1,\;0\leq y\leq 1\}$ である．
<br>
(2) $\displaystyle \iint_{D} x^2 \, dx\,dy$，
ただし領域は $D=\{(x,y)\mid 0\leq x\leq 1,\;0\leq y\leq x\}$ である．
```

## 人口増加の数理モデル

ある都市の人口が1年で2%ずつ増えるとき，ある年 $t$ の人口 $N(t)$ と次の年 $t+1$ の人口 $N(t+1)$ とは次のような関係を満たす．

$$
N(t+1) = N(t) \times 1.02.
$$

単位時間あたりの増加の割合が $r$ で一定のとき，ある時刻 $t$ の人口 $N(t)$ を用いて次の瞬間 $t+\varepsilon$ の人口 $N(t+\varepsilon)$ は次のように表せる．

$$
N(t+\varepsilon) = N(t) \times (1+r\varepsilon).
$$

ここで次のように式を操作する．

$$
\frac{N(t+\varepsilon)-N(t)}{\varepsilon} = r N(t)．
$$

ここで$\varepsilon \to \infty$の極限を取れば，

$$
\frac{dN}{dt} = r N(t)
$$

となる．
このように微分を用いて記述される方程式を微分方程式と呼ぶ．

```{note}
単位時間あたりの人口増加の割合（増殖率，マルサス係数）が $r$ のとき，時刻 $t$ における人口 $N(t)$ は次の微分方程式を満たす．

$$
\frac{dN}{dt} = r N(t)
\tag{1}
$$
```

この微分方程式を満たす $N(t)$ を具体的に知ることができれば，全ての時刻の人口を知ることができる．
微分方程式(1)は次のように解くことができる．

$$
\frac{1}{N(t)}\frac{dN}{dt} = r,
$$
$$
\frac{d}{dt}\log(N(t)) = r,
\tag{2}
$$
$$
\log(N(t)) = rt + C,
$$
ただし $C$ は積分定数．

$$
N(t) = e^{rt + C},
$$

まだ積分定数が決まらないため，全ての時刻の人口を知ることはできない．
積分定数を決めるためには情報が必要．
例えば今の時刻 $t=0$ での人口がすでに $N_0$ と分かっており，未来の時刻 $t$ での人口を求める問題と設定し直す．
そこで式(2)を時間について $0$ から $t$ まで定積分すれば，

$$
\log(N(t)) - \log(N_0) = rt,
$$
となる．従って

$$
\log\left(\frac{N(t)}{N_0}\right) = rt,
$$
$$
\frac{N(t)}{N_0} = e^{rt},
$$
$$
N(t) = N_0 e^{rt}.
$$

よってこの数理モデルに基けば，人口は時間が経つにつれて指数関数的に増大していくことが分かる．

## プログラミングの準備

### 作業フォルダの作成

本講義専用の作業フォルダを作成する．
ここではDocument（書類）以下に"mathematical_studies"フォルダを作成する．

### 演習ファイルの作成

1. Anacondaを起動する．
2. Jupyter Labを起動する．
3. 左のタブで Document/mathematical_studies フォルダを開き，演習ファイルを"1_{学籍番号}_{氏名}.ipynb"として作成する．

## 関数のプロット

インポートと初期設定

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams
rcParams['font.family'] = 'Hiragino Sans'
```

プロット
```
# FigureとAxesを生成する
fig, ax = plt.subplots(figsize=(5, 3))

# Axesに対してプロットする
x = np.linspace(0, 2*np.pi, 20)
ax.plot(x, 2*np.sin(x), 'bo--')# 青のoを点線で結ぶ

# Axesを装飾する
ax.set_xlim(0, 2*np.pi); ax.set_ylim(-2.1, 2.1)
ax.set_xlabel('X軸'); ax.set_ylabel('Y軸')

# Figureを保存する（相対パスを指定）
fig.savefig('./sin.png')
```

## まとめ

### 課題

本日作成したipynbファイルに追記する形で次の課題に回答し，WebClassの第1回課題から提出せよ．

```{note}
(1) 不思議に思う現象や仕組みが気になる現象を３つ挙げよ．

(2) そのうち1つを選び，現象に少しでも関係しそうな変数を思いつく限り挙げよ．

(3) マルサスモデルにおいて，初期値を$N_0=4$，$r=0.5$のときの人口$N(t)$のグラフをプロットせよ．

(4) 本日学んだことを3つ箇条書きで述べよ．
```

<br><br><br><br><br><br><br><br><br><br><br><br><br>

## 復習問題解答例

**復習１：微分（解答例）**

(1) $ f(x) = (1-x)^2(1+x)^2 = (1-x^2)^2 $
<br>
　$ f'(x) = 2(1-x^2)(-2x) = -4x(1-x^2) = 4x(x^2-1). $

(2) $ f(x) = e^{2x} $
<br>
　$ f'(x) = 2e^{2x}. $

(3) $ f(x) = \sin(2\pi x) $
<br>
　$ f'(x) = 2\pi \cos(2\pi x). $

(4) $ f(x) = \log\!\left(\frac{x}{2}\right) = \log x - \log 2 $
<br>
　$ f'(x) = \frac{1}{x} \quad (x>0). $

(5) $ f(x) = \frac{1-x}{x^2} = x^{-2} - x^{-1} $
<br>
　$ f'(x) = -2x^{-3} + x^{-2} = \frac{x-2}{x^3} \quad (x\ne 0). $

(6) $ f(x) = x^2 e^{3x} $
<br>
　$ f'(x) = 2x e^{3x} + 3x^2 e^{3x} = e^{3x}(2x+3x^2). $

(7) $ f(x) = x\log x $
<br>
　$ f'(x) = \log x + 1 \quad (x>0). $

(8) $ f(x) = \sin(x^2) $
<br>
　$ f'(x) = 2x\cos(x^2). $

**復習２：極大・極小（解答例）**

$ f(x) = (1-x)^2(1+x)^2 = (1-x^2)^2 $ に対して
$ f'(x) = 4x(x^2-1), \qquad f''(x) = 12x^2 - 4$であるから，

- 臨界点： $ x=0,\ \pm 1. $
- $x=0:\ f''(0)=-4<0 \Rightarrow \text{極大},\ \ f(0)=1$．
- $x=\pm 1:\ f''(\pm 1)=8>0 \Rightarrow \text{極小},\ \ f(\pm 1)=0$

従って $x=0$で極大値$1$，$x=\pm 1$で極小値$0$を取る．

**復習３：定積分（解答例）**

(1) $\displaystyle \int_0^1 (1-x)^2\,dx = \int_0^1 (1-2x+x^2)\,dx = \Big[x - x^2 + \tfrac{x^3}{3}\Big]_0^1 = \tfrac{1}{3}.$

(2) $\displaystyle \int_0^{\pi}\sin x\,dx = [-\cos x]_0^{\pi} = 2.$

(3) $\displaystyle \int_1^e \frac{1}{x}\,dx = [\log x]_1^e = 1.$

(4) $\displaystyle \int_0^1 x e^x\,dx = \big[(x-1)e^x\big]_0^1 = 1.$

(5) $\displaystyle \int_0^{\pi/2}\cos^2 x\,dx = \int_0^{\pi/2}\frac{1+\cos 2x}{2}\,dx = \frac{1}{2}\Big[x+\frac{\sin 2x}{2}\Big]_0^{\pi/2} = \frac{\pi}{4}.$

**復習４：偏微分（解答例）**

$f(x,y) = \dfrac{y}{x^2+y^2}, \qquad (x,y)\ne(0,0)$ に対して，1次偏導関数は

$$
f_x = -\dfrac{2xy}{(x^2+y^2)^2}, \qquad f_y = \dfrac{x^2-y^2}{(x^2+y^2)^2}
$$

従って2次偏導関数は

$$
f_{xx} = \frac{2y(3x^2-y^2)}{(x^2+y^2)^3}, 
f_{xy} = \frac{2x(-x^2+3y^2)}{(x^2+y^2)^3},
f_{yy} = \frac{2y(y^2-3x^2)}{(x^2+y^2)^3}.
$$

**復習５：重積分（解答例）**

(1)（領域 $D=[0,1]\times[0,1]$）

$$
\iint_{D} (x+y)\,dx\,dy
= \int_0^1 \left[\int_0^1 (x+y)\,dx\right]dy
= \int_0^1 \left(\frac{1}{2}+y\right)dy
= \left[\frac{y}{2}+\frac{y^2}{2}\right]_0^1
= 1.
$$

(2)（領域 $D=\{(x,y)\mid 0\le y\le x\le 1\} $）

$$
\iint_{D} x^2\,dx\,dy
= \int_0^1 \left[\int_0^x x^2\,dy\right]dx
= \int_0^1 x^2(x-0)\,dx
= \int_0^1 x^3\,dx
= \left[\frac{x^4}{4}\right]_0^1
= \frac{1}{4}.
$$
