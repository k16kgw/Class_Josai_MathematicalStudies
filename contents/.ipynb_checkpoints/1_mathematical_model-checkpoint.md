# 数理モデルの導入・演習

到達目標
- 数理モデルの意義と考え方を理解する．
- 簡単なモデルを通じて基礎力を確認する．

<!-- 
アイデア
- （情報数理学科の学びと本講義の学びの関係）まだ数学科なのでここは触れなくて良い．
- 情報とはデータ．データは現実を数値化したもの．現実をよく知ることでデータをうまく扱えるようになる．
- 現実をよく知ることとは，どのようなメカニズムで現象が起きているのか，加えて数理的構造を理解すること．
- 数学的に扱うには数学を自在に使えることが必要．
- 数理モデルが一番うまくいっているのは物理学．次に数理生物学
-->

## 現実と数学の違い

### 数理モデルとは

広辞苑で「モデル」を引くと
<br>
②模型。雛型。
<br>
③現象や構造を理論的に抽象化したもの。
<br>
④模範。手本。

同じく「模型」を引くと
<br>
①同形のものを造るための型。ひながた。ぼけい。
<br>
②実物の形に似せて造ったもの。

- モデルガン：実物そっくりに作った玩具の銃
- モデルルーム：実物と同じ作りをした見本の部屋

<span style="color:red">模型とは，何か本物があり，それを真似して作られるもの．</span>

本物…実現象（自然現象・社会現象・人間活動など）

```{tip}
実現象の例

- ものの落下
- 星の運行
- 冷房による部屋の冷え方
- 光の届き方
- 毛穴のでき方
- 腸内細菌叢の状況
- チーターの模様のでき方
- 人口の変動
- 感染症の流行
- 渋滞のでき方
- 株価の変動
- サッカーのフォーメーション
```

```{note}
**次回までの復習課題１**

生活している中で，不思議に思った現象や仕組みが気になる現象を３つ見つけてくること．
```

### データ分析から数理モデリングへ

世の中のものは<span style="color:red">数値</span>として観測される．
その数値がどのようにして定まるかは，物理法則や統計的なルールなどによって決まる．

そのルールを見出すのがモデリングという作業になる．
特に数学的なルールを見出す場合を数理モデリングと呼び，それにより造られる模型を「<span style="color:red">数理モデル</span>」と呼ぶ．
数理モデルを用いれば，現実のルールを再現しているので，未知の現象の予測に役立つことがある．

しかしながら，数理モデルは現実そのまま丸ごと再現しているわけではなく<span style="color:red">人間が見出したルールのみを再現している</span>ため，見出したルール外の現象に対しては予測がうまくいかなくなる．

## 微分積分の復習

以下の5問に取り組むこと．
始めの25分間は何も見ずに回答すること．
次の15分間は分からなかった箇所を調べながら，青ペンで回答すること．

```{note}
**復習１：微分**

次の関数 $f$ の導関数 $f^{\prime}(x)$ を求めよ．

(1) $f(x) = (1-x)^2(1+x)^2$．
<br>
(2) $f(x) = e^{2 x}$．
<br>
(3) $f(x) = \sin(2\pi x)$．
<br>
(4) $f(x) = \log\left( \dfrac{x}{2} \right)$，ただし$x > 0$．
<br>
(5) $f(x) = \dfrac{1-x}{x^2}$，ただし$x \neq 0$．
<br>
(6) $f(x) = x^2 e^{3x}$
<br>
(7) $f(x) = x \log{x}$
<br>
(8) $f(x) = \sin(x^2)$．
```

```{note}
**復習２：極大・極小**

関数 $f(x) = (1-x)^2(1+x)^2$ の極大値・極小値とそれを取る $x$ を全て求めよ．
```

```{note}
**復習３：定積分**

次の定積分を計算せよ．

(1) $\displaystyle \int_0^1 (1-x)^2 \, dx$
<br>
(2) $\displaystyle \int_0^{\pi} \sin(x) \, dx$
<br>
(3) $\displaystyle \int_{1}^{e} \dfrac{1}{x} \, dx$
<br>
(4) $\displaystyle \int_0^1 x e^x \, dx$
<br>
(5) $\displaystyle \int_0^{\pi/2} \cos^2 x \, dx$
```

```{note}
**復習４：偏微分**

次の2変数関数 $f$ の2次導関数 $\frac{\partial^2 f}{\partial x^2}$，$\frac{\partial^2 f}{\partial x \partial y}$，$\frac{\partial^2 f}{\partial y^2}$ を求めよ．

(1) $f(x,y) = \dfrac{y}{x^2+y^2}$，ただし$(x,y) \neq (0,0)$．


## 人口増加の数理モデル

ある都市の人口が1年で2%ずつ増えるとき，ある年 $t$ の人口 $N(t)$ と次の年 $t+1$ の人口 $N(t+1)$ とは次のような関係を満たす．

$$
N(t+1) = N(t) \times 1.02.
$$

単位時間あたりの増加の割合が $r$ で一定のとき，ある時刻 $t$ の人口 $N(t)$ を用いて次の瞬間 $t+\varepsilon$ の人口 $N(t+\varepsilon)$ は次のように表せる．

$$
N(t+\varepsilon) = N(t) \times (1+r\varepsilon).
$$

ここで次のように式を操作する．

$$
\frac{N(t+\varepsilon)-N(t)}{\varepsilon} = r N(t)．
$$

ここで$\varepsilon \to \infty$の極限を取れば，

$$
\frac{dN}{d\varepsilon} = r N(t)
$$

となる．
このように微分を用いて記述される方程式を微分方程式と呼ぶ．

```{note}
単位時間あたりの人口増加の割合（増殖率，マルサス係数）が $r$ のとき，時刻 $t$ における人口 $N(t)$ は次の微分方程式を満たす．

$$
\frac{dN}{d\varepsilon} = r N(t)
\tag{1}
$$
```

この微分方程式を満たす $N(t)$ を具体的に知ることができれば，全ての時刻の人口を知ることができる．
微分方程式(1)は次のように解くことができる．

$$
\frac{1}{N(t)}\frac{dN}{d\varepsilon} = r,
$$
$$
\frac{d}{dt}\log(N(t)) = r,
\tag{2}
$$
$$
\log(N(t)) = rt + C,
$$
ただし $C$ は積分定数．

$$
N(t) = e^{rt + C},
$$

まだ積分定数が決まらないため，全ての時刻の人口を知ることはできない．
積分定数を決めるためには情報が必要．
例えば今の時刻 $t=0$ での人口がすでに $N_0$ と分かっており，未来の時刻 $t$ での人口を求める問題と設定し直す．
そこで式(2)を時間について $0$ から $t$ まで定積分すれば，

$$
\log(N(t)) - \log(N_0) = rt,
$$
となる．従って

$$
\log\left(\frac{N(t)}{N_0}\right) = rt,
$$
$$
\frac{N(t)}{N_0} = e^{rt},
$$
$$
N(t) = N_0 e^{rt}.
$$

よってこの数理モデルに基けば，人口は時間が経つにつれて指数関数的に増大していくことが分かる．

## プログラミングの準備

### 作業フォルダの作成

本講義専用の作業フォルダを作成する．
ここではDocument（書類）以下に"mathematical_studies"フォルダを作成する．

## 関数のプロット


